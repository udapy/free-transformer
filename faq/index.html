
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A Llama-style decoder architecture with explicit latent plans and conditional VAE training">
      
      
        <meta name="author" content="Uday Phalak">
      
      
        <link rel="canonical" href="https://udapy.github.io/free-transformer/faq/">
      
      
        <link rel="prev" href="../development/quality/">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>FAQ - Free Transformer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-green" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frequently-asked-questions" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Free Transformer Documentation" class="md-header__button md-logo" aria-label="Free Transformer Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Free Transformer Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              FAQ
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="deep-green" data-md-color-accent="red"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-green" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/udapy/free-transformer" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    udapy/free-transformer
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../getting-started/installation/" class="md-tabs__link">
          
  
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../architecture/overview/" class="md-tabs__link">
          
  
  
  Architecture

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../training/guide/" class="md-tabs__link">
          
  
  
  Training

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/model/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/basic/" class="md-tabs__link">
          
  
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../development/contributing/" class="md-tabs__link">
          
  
  
  Development

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Free Transformer Documentation" class="md-nav__button md-logo" aria-label="Free Transformer Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Free Transformer Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/udapy/free-transformer" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    udapy/free-transformer
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Setup
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/free-transformer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Free Transformer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/baseline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Baseline Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../architecture/latent-planning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Latent Planning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Training
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/multi-gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-GPU
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/synthetic-data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Synthetic Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Training Utils
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/losses/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Losses
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic Usage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/custom-training/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom Training
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/evaluation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Evaluation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../development/quality/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code Quality
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-questions" class="md-nav__link">
    <span class="md-ellipsis">
      General Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-the-free-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      What is the Free Transformer?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-does-it-differ-from-standard-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      How does it differ from standard Transformers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-are-the-main-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      What are the main benefits?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-the-latent-dimension-and-how-do-i-choose-it" class="md-nav__link">
    <span class="md-ellipsis">
      What is the latent dimension and how do I choose it?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-free-bits-and-why-is-it-important" class="md-nav__link">
    <span class="md-ellipsis">
      What is "free bits" and why is it important?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-know-if-my-model-is-working-correctly" class="md-nav__link">
    <span class="md-ellipsis">
      How do I know if my model is working correctly?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-the-difference-between-training-and-inference-modes" class="md-nav__link">
    <span class="md-ellipsis">
      What's the difference between training and inference modes?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-i-use-this-for-real-world-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Can I use this for real-world datasets?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-run-on-multiple-gpus" class="md-nav__link">
    <span class="md-ellipsis">
      How do I run on multiple GPUs?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can-i-run-this-without-a-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      Can I run this without a GPU?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-change-the-model-size" class="md-nav__link">
    <span class="md-ellipsis">
      How do I change the model size?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Training Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#my-kl-loss-is-zero-whats-wrong" class="md-nav__link">
    <span class="md-ellipsis">
      My KL loss is zero. What's wrong?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-is-unstable-how-do-i-fix-it" class="md-nav__link">
    <span class="md-ellipsis">
      Training is unstable. How do I fix it?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-long-should-i-train" class="md-nav__link">
    <span class="md-ellipsis">
      How long should I train?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#should-i-use-curriculum-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Should I use curriculum learning?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comparison Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-does-it-compare-to-other-vae-based-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      How does it compare to other VAE-based language models?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-should-i-use-free-transformer-vs-standard-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      When should I use Free Transformer vs standard Transformer?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-i-deploy-this-in-production" class="md-nav__link">
    <span class="md-ellipsis">
      Can I deploy this in production?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-optimize-for-inference" class="md-nav__link">
    <span class="md-ellipsis">
      How do I optimize for inference?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can-i-convert-to-onnx-or-tensorrt" class="md-nav__link">
    <span class="md-ellipsis">
      Can I convert to ONNX or TensorRT?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Development Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-do-i-contribute" class="md-nav__link">
    <span class="md-ellipsis">
      How do I contribute?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-add-custom-components" class="md-nav__link">
    <span class="md-ellipsis">
      How do I add custom components?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-can-i-get-help" class="md-nav__link">
    <span class="md-ellipsis">
      Where can I get help?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-much-slower-is-it-than-baseline-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      How much slower is it than baseline Transformers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-much-memory-does-it-use" class="md-nav__link">
    <span class="md-ellipsis">
      How much memory does it use?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can-i-make-it-faster" class="md-nav__link">
    <span class="md-ellipsis">
      Can I make it faster?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#general-questions" class="md-nav__link">
    <span class="md-ellipsis">
      General Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="General Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-the-free-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      What is the Free Transformer?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-does-it-differ-from-standard-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      How does it differ from standard Transformers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-are-the-main-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      What are the main benefits?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-is-the-latent-dimension-and-how-do-i-choose-it" class="md-nav__link">
    <span class="md-ellipsis">
      What is the latent dimension and how do I choose it?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-is-free-bits-and-why-is-it-important" class="md-nav__link">
    <span class="md-ellipsis">
      What is "free bits" and why is it important?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-know-if-my-model-is-working-correctly" class="md-nav__link">
    <span class="md-ellipsis">
      How do I know if my model is working correctly?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whats-the-difference-between-training-and-inference-modes" class="md-nav__link">
    <span class="md-ellipsis">
      What's the difference between training and inference modes?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-i-use-this-for-real-world-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      Can I use this for real-world datasets?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-run-on-multiple-gpus" class="md-nav__link">
    <span class="md-ellipsis">
      How do I run on multiple GPUs?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can-i-run-this-without-a-gpu" class="md-nav__link">
    <span class="md-ellipsis">
      Can I run this without a GPU?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-change-the-model-size" class="md-nav__link">
    <span class="md-ellipsis">
      How do I change the model size?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#training-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Training Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Training Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#my-kl-loss-is-zero-whats-wrong" class="md-nav__link">
    <span class="md-ellipsis">
      My KL loss is zero. What's wrong?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#training-is-unstable-how-do-i-fix-it" class="md-nav__link">
    <span class="md-ellipsis">
      Training is unstable. How do I fix it?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-long-should-i-train" class="md-nav__link">
    <span class="md-ellipsis">
      How long should I train?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#should-i-use-curriculum-learning" class="md-nav__link">
    <span class="md-ellipsis">
      Should I use curriculum learning?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comparison-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Comparison Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Comparison Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-does-it-compare-to-other-vae-based-language-models" class="md-nav__link">
    <span class="md-ellipsis">
      How does it compare to other VAE-based language models?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#when-should-i-use-free-transformer-vs-standard-transformer" class="md-nav__link">
    <span class="md-ellipsis">
      When should I use Free Transformer vs standard Transformer?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#can-i-deploy-this-in-production" class="md-nav__link">
    <span class="md-ellipsis">
      Can I deploy this in production?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-optimize-for-inference" class="md-nav__link">
    <span class="md-ellipsis">
      How do I optimize for inference?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can-i-convert-to-onnx-or-tensorrt" class="md-nav__link">
    <span class="md-ellipsis">
      Can I convert to ONNX or TensorRT?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Development Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-do-i-contribute" class="md-nav__link">
    <span class="md-ellipsis">
      How do I contribute?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-do-i-add-custom-components" class="md-nav__link">
    <span class="md-ellipsis">
      How do I add custom components?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-can-i-get-help" class="md-nav__link">
    <span class="md-ellipsis">
      Where can I get help?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-questions" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-much-slower-is-it-than-baseline-transformers" class="md-nav__link">
    <span class="md-ellipsis">
      How much slower is it than baseline Transformers?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#how-much-memory-does-it-use" class="md-nav__link">
    <span class="md-ellipsis">
      How much memory does it use?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#can-i-make-it-faster" class="md-nav__link">
    <span class="md-ellipsis">
      Can I make it faster?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="frequently-asked-questions">Frequently Asked Questions<a class="headerlink" href="#frequently-asked-questions" title="Permanent link">&para;</a></h1>
<h2 id="general-questions">General Questions<a class="headerlink" href="#general-questions" title="Permanent link">&para;</a></h2>
<h3 id="what-is-the-free-transformer">What is the Free Transformer?<a class="headerlink" href="#what-is-the-free-transformer" title="Permanent link">&para;</a></h3>
<p>The Free Transformer is a novel neural architecture that extends traditional autoregressive Transformers with explicit latent planning. Instead of generating tokens purely reactively based on previous tokens, it first creates an abstract "plan" (latent variable Z) and then generates tokens conditioned on both the history and this plan.</p>
<h3 id="how-does-it-differ-from-standard-transformers">How does it differ from standard Transformers?<a class="headerlink" href="#how-does-it-differ-from-standard-transformers" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Aspect</th>
<th>Standard Transformer</th>
<th>Free Transformer</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Generation</strong></td>
<td>Reactive (token-by-token)</td>
<td>Plan-then-generate</td>
</tr>
<tr>
<td><strong>Training</strong></td>
<td>Language modeling loss</td>
<td>Conditional VAE loss</td>
</tr>
<tr>
<td><strong>Coherence</strong></td>
<td>Local</td>
<td>Global + Local</td>
</tr>
<tr>
<td><strong>Controllability</strong></td>
<td>Limited</td>
<td>High (via plan manipulation)</td>
</tr>
<tr>
<td><strong>Architecture</strong></td>
<td>Decoder-only</td>
<td>Decoder + Encoder + Latent</td>
</tr>
</tbody>
</table>
<h3 id="what-are-the-main-benefits">What are the main benefits?<a class="headerlink" href="#what-are-the-main-benefits" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Better long-range coherence</strong>: The latent plan helps maintain consistency across long sequences</li>
<li><strong>Controllable generation</strong>: You can potentially manipulate the latent plan for controlled text generation</li>
<li><strong>Richer representations</strong>: The model learns more structured internal representations</li>
<li><strong>Improved sample diversity</strong>: Different plans lead to different generation styles</li>
</ol>
<h2 id="technical-questions">Technical Questions<a class="headerlink" href="#technical-questions" title="Permanent link">&para;</a></h2>
<h3 id="what-is-the-latent-dimension-and-how-do-i-choose-it">What is the latent dimension and how do I choose it?<a class="headerlink" href="#what-is-the-latent-dimension-and-how-do-i-choose-it" title="Permanent link">&para;</a></h3>
<p>The latent dimension (<code>latent_dim</code>) determines the size of the binary plan vector Z. Typical values:</p>
<ul>
<li><strong>Small models (&lt; 100M params)</strong>: 8-16 dimensions</li>
<li><strong>Medium models (100M-1B params)</strong>: 16-32 dimensions  </li>
<li><strong>Large models (&gt; 1B params)</strong>: 32-64 dimensions</li>
</ul>
<p>Start with 16-32 and adjust based on your model size and task complexity.</p>
<h3 id="what-is-free-bits-and-why-is-it-important">What is "free bits" and why is it important?<a class="headerlink" href="#what-is-free-bits-and-why-is-it-important" title="Permanent link">&para;</a></h3>
<p>Free bits is a regularization technique that prevents posterior collapse in VAE training. It sets a minimum threshold for the KL divergence loss:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">kl_loss</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">kl_loss</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="n">free_bits</span><span class="p">)</span>
</code></pre></div>
<p>Typical values: 0.5-2.0. Higher values encourage more latent variable usage but may hurt reconstruction quality.</p>
<h3 id="how-do-i-know-if-my-model-is-working-correctly">How do I know if my model is working correctly?<a class="headerlink" href="#how-do-i-know-if-my-model-is-working-correctly" title="Permanent link">&para;</a></h3>
<p>Monitor these metrics during training:</p>
<ol>
<li><strong>KL loss should be positive</strong>: If it drops to zero, you have posterior collapse</li>
<li><strong>Reconstruction loss should decrease</strong>: Standard language modeling progress</li>
<li><strong>Total loss should be stable</strong>: No sudden spikes or instability</li>
<li><strong>Generation quality</strong>: Manually inspect generated text</li>
</ol>
<h3 id="whats-the-difference-between-training-and-inference-modes">What's the difference between training and inference modes?<a class="headerlink" href="#whats-the-difference-between-training-and-inference-modes" title="Permanent link">&para;</a></h3>
<p><strong>Training mode</strong>:
- Uses the encoder to compute latent plan from the full sequence
- Optimizes both reconstruction and KL losses
- Plan is derived from the actual data</p>
<p><strong>Inference mode</strong>:
- Samples latent plan from uniform prior (no encoder needed)
- Only uses reconstruction for generation
- Plan is randomly sampled</p>
<h2 id="usage-questions">Usage Questions<a class="headerlink" href="#usage-questions" title="Permanent link">&para;</a></h2>
<h3 id="can-i-use-this-for-real-world-datasets">Can I use this for real-world datasets?<a class="headerlink" href="#can-i-use-this-for-real-world-datasets" title="Permanent link">&para;</a></h3>
<p>Yes! While the examples use synthetic data for quick prototyping, the model works with any text dataset. You can:</p>
<ol>
<li>Use HuggingFace datasets directly</li>
<li>Provide your own text files</li>
<li>Modify the data loading pipeline in <code>synthetic_data.py</code></li>
</ol>
<h3 id="how-do-i-run-on-multiple-gpus">How do I run on multiple GPUs?<a class="headerlink" href="#how-do-i-run-on-multiple-gpus" title="Permanent link">&para;</a></h3>
<p>Use FSDP (Fully Sharded Data Parallel):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Automatic GPU detection</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>torchrun<span class="w"> </span>--nproc_per_node<span class="o">=</span>auto<span class="w"> </span>examples/train_free.py<span class="w"> </span>--config<span class="w"> </span>configs/free_transformer.yaml<span class="w"> </span>--use-fsdp
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Or use the Makefile</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>make<span class="w"> </span>train-free-fsdp
</code></pre></div>
<h3 id="can-i-run-this-without-a-gpu">Can I run this without a GPU?<a class="headerlink" href="#can-i-run-this-without-a-gpu" title="Permanent link">&para;</a></h3>
<p>Yes, but it will be much slower. Use the CPU Docker image:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>make<span class="w"> </span>docker-build-cpu
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>make<span class="w"> </span>docker-run-cpu
</code></pre></div>
<p>Or set device in your code:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">model</span> <span class="o">=</span> <span class="n">FreeTransformer</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="how-do-i-change-the-model-size">How do I change the model size?<a class="headerlink" href="#how-do-i-change-the-model-size" title="Permanent link">&para;</a></h3>
<p>Edit the configuration file or create a new one:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">model</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">hidden_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">768</span><span class="w">      </span><span class="c1"># Increase for larger model</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">num_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">24</span><span class="w">       </span><span class="c1"># More layers = more capacity</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">num_heads</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span><span class="w">        </span><span class="c1"># Usually hidden_dim // 64</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nt">latent_dim</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span><span class="w">       </span><span class="c1"># Scale with model size</span>
</code></pre></div>
<h2 id="training-questions">Training Questions<a class="headerlink" href="#training-questions" title="Permanent link">&para;</a></h2>
<h3 id="my-kl-loss-is-zero-whats-wrong">My KL loss is zero. What's wrong?<a class="headerlink" href="#my-kl-loss-is-zero-whats-wrong" title="Permanent link">&para;</a></h3>
<p>This is posterior collapse. The model is ignoring the latent variable. Solutions:</p>
<ol>
<li><strong>Increase free bits</strong>: Try 1.0-2.0 instead of 0.5</li>
<li><strong>Reduce KL weight</strong>: Start with 0.01-0.05 instead of 0.1</li>
<li><strong>Use KL annealing</strong>: Gradually increase KL weight during training</li>
<li><strong>Check latent dimension</strong>: Might be too large for your model</li>
</ol>
<h3 id="training-is-unstable-how-do-i-fix-it">Training is unstable. How do I fix it?<a class="headerlink" href="#training-is-unstable-how-do-i-fix-it" title="Permanent link">&para;</a></h3>
<p>Common solutions:</p>
<ol>
<li><strong>Gradient clipping</strong>: <code>torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)</code></li>
<li><strong>Lower learning rate</strong>: Try 1e-5 instead of 1e-4</li>
<li><strong>Warmup</strong>: Use learning rate warmup for first 1000 steps</li>
<li><strong>Mixed precision</strong>: Can help with stability and speed</li>
</ol>
<h3 id="how-long-should-i-train">How long should I train?<a class="headerlink" href="#how-long-should-i-train" title="Permanent link">&para;</a></h3>
<p>Depends on your dataset and model size:</p>
<ul>
<li><strong>Small synthetic data</strong>: 5-10 epochs</li>
<li><strong>Medium datasets (1M-10M tokens)</strong>: 10-50 epochs</li>
<li><strong>Large datasets (100M+ tokens)</strong>: 1-5 epochs</li>
</ul>
<p>Monitor validation loss and stop when it plateaus.</p>
<h3 id="should-i-use-curriculum-learning">Should I use curriculum learning?<a class="headerlink" href="#should-i-use-curriculum-learning" title="Permanent link">&para;</a></h3>
<p>Yes, it often helps! Start with:</p>
<ol>
<li><strong>Short sequences</strong> (128 tokens)  <strong>Long sequences</strong> (512+ tokens)</li>
<li><strong>High KL weight</strong> (1.0)  <strong>Low KL weight</strong> (0.1)</li>
<li><strong>Simple data</strong>  <strong>Complex data</strong></li>
</ol>
<h2 id="comparison-questions">Comparison Questions<a class="headerlink" href="#comparison-questions" title="Permanent link">&para;</a></h2>
<h3 id="how-does-it-compare-to-other-vae-based-language-models">How does it compare to other VAE-based language models?<a class="headerlink" href="#how-does-it-compare-to-other-vae-based-language-models" title="Permanent link">&para;</a></h3>
<p>The Free Transformer is specifically designed for autoregressive generation with:</p>
<ul>
<li><strong>Explicit binary plans</strong>: More interpretable than continuous latents</li>
<li><strong>Llama-style backbone</strong>: Modern, efficient architecture</li>
<li><strong>Flexible injection</strong>: Plan can influence multiple layers</li>
<li><strong>Training efficiency</strong>: Competitive with standard Transformers</li>
</ul>
<h3 id="when-should-i-use-free-transformer-vs-standard-transformer">When should I use Free Transformer vs standard Transformer?<a class="headerlink" href="#when-should-i-use-free-transformer-vs-standard-transformer" title="Permanent link">&para;</a></h3>
<p><strong>Use Free Transformer when</strong>:
- You need better long-range coherence
- Controllable generation is important
- You're working with structured text (stories, articles)
- Sample diversity matters</p>
<p><strong>Use standard Transformer when</strong>:
- You need maximum training efficiency
- Working with very short sequences
- Simplicity is preferred
- You have limited computational resources</p>
<h2 id="deployment-questions">Deployment Questions<a class="headerlink" href="#deployment-questions" title="Permanent link">&para;</a></h2>
<h3 id="can-i-deploy-this-in-production">Can I deploy this in production?<a class="headerlink" href="#can-i-deploy-this-in-production" title="Permanent link">&para;</a></h3>
<p>Yes, but consider:</p>
<ol>
<li><strong>Inference mode is efficient</strong>: No encoder overhead</li>
<li><strong>Model size</strong>: Similar to equivalent standard Transformer</li>
<li><strong>Memory usage</strong>: Slightly higher due to latent computations</li>
<li><strong>Latency</strong>: Comparable to baseline models</li>
</ol>
<h3 id="how-do-i-optimize-for-inference">How do I optimize for inference?<a class="headerlink" href="#how-do-i-optimize-for-inference" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Use inference mode</strong>: <code>model(tokens, mode='inference')</code></li>
<li><strong>Enable eval mode</strong>: <code>model.eval()</code></li>
<li><strong>Disable gradients</strong>: <code>torch.no_grad()</code></li>
<li><strong>Consider quantization</strong>: Standard PyTorch quantization works</li>
<li><strong>Batch inference</strong>: Process multiple sequences together</li>
</ol>
<h3 id="can-i-convert-to-onnx-or-tensorrt">Can I convert to ONNX or TensorRT?<a class="headerlink" href="#can-i-convert-to-onnx-or-tensorrt" title="Permanent link">&para;</a></h3>
<p>The model uses standard PyTorch operations, so conversion should work, but:</p>
<ol>
<li><strong>Test thoroughly</strong>: Some operations might not be supported</li>
<li><strong>Separate modes</strong>: Export training and inference modes separately</li>
<li><strong>Dynamic shapes</strong>: May need fixed input sizes</li>
</ol>
<h2 id="development-questions">Development Questions<a class="headerlink" href="#development-questions" title="Permanent link">&para;</a></h2>
<h3 id="how-do-i-contribute">How do I contribute?<a class="headerlink" href="#how-do-i-contribute" title="Permanent link">&para;</a></h3>
<ol>
<li>Fork the repository</li>
<li>Create a feature branch</li>
<li>Make your changes</li>
<li>Run tests: <code>make test</code></li>
<li>Run quality checks: <code>make quality</code></li>
<li>Submit a pull request</li>
</ol>
<h3 id="how-do-i-add-custom-components">How do I add custom components?<a class="headerlink" href="#how-do-i-add-custom-components" title="Permanent link">&para;</a></h3>
<p>The architecture is modular:</p>
<ol>
<li><strong>Custom encoder</strong>: Inherit from <code>nn.Module</code>, implement <code>forward()</code></li>
<li><strong>Custom injection</strong>: Modify <code>injection.py</code></li>
<li><strong>Custom losses</strong>: Add to <code>losses.py</code></li>
<li><strong>Custom data</strong>: Extend <code>synthetic_data.py</code></li>
</ol>
<h3 id="where-can-i-get-help">Where can I get help?<a class="headerlink" href="#where-can-i-get-help" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Documentation</strong>: This site covers most use cases</li>
<li><strong>GitHub Issues</strong>: Report bugs or ask questions</li>
<li><strong>Code examples</strong>: Check the <code>examples/</code> directory</li>
<li><strong>Tests</strong>: Look at <code>tests/</code> for usage patterns</li>
</ol>
<h2 id="performance-questions">Performance Questions<a class="headerlink" href="#performance-questions" title="Permanent link">&para;</a></h2>
<h3 id="how-much-slower-is-it-than-baseline-transformers">How much slower is it than baseline Transformers?<a class="headerlink" href="#how-much-slower-is-it-than-baseline-transformers" title="Permanent link">&para;</a></h3>
<p><strong>Training</strong>: ~20-30% slower due to encoder and VAE loss
<strong>Inference</strong>: ~5-10% slower due to latent computations</p>
<p>The overhead is minimal and often worth it for the improved capabilities.</p>
<h3 id="how-much-memory-does-it-use">How much memory does it use?<a class="headerlink" href="#how-much-memory-does-it-use" title="Permanent link">&para;</a></h3>
<p><strong>Training</strong>: ~30-40% more memory than baseline (due to encoder)
<strong>Inference</strong>: ~10-15% more memory than baseline</p>
<p>Use gradient checkpointing and mixed precision to reduce memory usage.</p>
<h3 id="can-i-make-it-faster">Can I make it faster?<a class="headerlink" href="#can-i-make-it-faster" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Use mixed precision</strong>: <code>torch.cuda.amp</code></li>
<li><strong>Gradient checkpointing</strong>: Trades compute for memory</li>
<li><strong>Efficient attention</strong>: Flash Attention (planned feature)</li>
<li><strong>Model parallelism</strong>: FSDP for large models</li>
<li><strong>Batch size tuning</strong>: Find optimal batch size for your hardware</li>
</ol>
<p>Still have questions? <a href="https://github.com/udapy/free-transformer/issues">Open an issue</a> on GitHub!</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.highlight", "search.share", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>